<map proto="1.5.0" min-server-version="1.21.8">
    <name>Random Items: KOTF</name>
    <created>2026-01-31</created>
    <version>1.0.0</version>
    <objective>Pickup the flags at mid and get points. Get a random item every ${period} seconds.</objective>
    <authors>
        <author uuid="d5a64b26-15ea-46c4-8319-f9c83e82a1fa"/> <!-- Eliminate -->
    </authors>
    <contributors>
        <contributor uuid="9d4779a8-d35f-45d2-b51c-95de7a77e128" contribution="The goat (i stole half of his xml)"/>    <!-- zzuf -->
    </contributors>
    <include id="void-death"/>
    <constants>
        <constant id="period">3</constant>
        <constant id="period-less">2.9</constant>
        <constant id="period-half">1.5</constant>
    </constants>
    <players max="16" max-overfill="16" colors="true"/>
    <kits>
        <kit id="stop-falling-kit">
            <boots material="prismarine" locked="true"> <!-- material is on purpose as it doesn't show -->
                <attribute operation="add" amount="-0.42">generic.jump_strength</attribute>
                <attribute operation="add" amount="-0.1">generic.movement_speed</attribute>
                <attribute operation="add" amount="1">generic.knockback_resistance</attribute>
            </boots>
        </kit>
        <kit id="remove-stop-falling-kit" force="true">
            <clear items="false" effects="false" armor="true"/>
        </kit>
        <give kit="remove-stop-falling-kit" filter="stop-falling"/>
        <kit id="flag-kit" force="true">
            <max-health>14</max-health>
        </kit>
        <kit id="magenta-kit" force="true">
            <max-health>10</max-health>
        </kit>
        <kit id="flag-effects">
            <effect>glowing</effect>
        </kit>
        <kit id="reset-health" force="true">
            <max-health>20</max-health>
        </kit>
        <kit id="air-kit" force="true">
            <helmet material="air"/>
        </kit>
    </kits>
    <spawns>
        <default>
            <region>
                <point>0.5,45,0.5</point>
            </region>
        </default>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>0.5,11,20.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-6.5,11,18.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-13.5,11,14.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-17.5,11,7.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-19.5,11,0.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-17.5,11,-6.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-13.5,11,-13.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>-6.5,11,-17.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>0.5,11,-19.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>7.5,11,-17.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>14.5,11,-13.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>18.5,11,-6.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>20.5,11,0</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>18.5,11,7.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>14.5,11,14.5</point></region></spawn>
        <spawn spread="true" exclusive="true" kit="stop-falling-kit"><region angle="0.5,11,0.5"><point>7,11,18.5</point></region></spawn>
    </spawns>
    <regions>
        <apply block="never">
            <region>
                <union>
                    <negative>
                        <circle id="playable" center="0.5,0.5" radius="25"/>
                    </negative>
                    <above y="25"/>
                    <below y="0"/>
                </union>
            </region>
        </apply>
        <rectangle id="flag-remover" min="-7.5,8.5" max="8.5,-7.5"/>
    </regions>
    <filters>
        <after id="stop-falling" duration="${period}s">
            <alive/>
        </after>
        <pulse id="new-item-pulse" duration="0.25s" period="${period}s">
            <after duration="${period}s">
                <match-running/>
            </after>
        </pulse>
        <pulse id="new-item-pulse2" duration="0.25s" period="${period}s">
            <after duration="${period-half}s">
                <match-running/>
            </after>
        </pulse>
        <countdown duration="${period}s" message="Next item in {0}">
            <pulse duration="${period-less}s" period="${period}s">
                <match-running/>
            </pulse>
        </countdown>
        <all id="red-checker">
            <flag-carried>red-flag</flag-carried>
        </all>
        <all id="blue-checker">
            <flag-carried>blue-flag</flag-carried>
        </all>
        <all id="yellow-checker">
            <flag-carried>yellow-flag</flag-carried>
        </all>
        <all id="green-checker">
            <flag-carried>green-flag</flag-carried>
        </all>
        <all id="magenta-checker">
            <flag-carried>magenta-flag</flag-carried>
        </all>
    </filters>
    <variables>
        <variable id="new_item" default="-1" scope="player"/>
    </variables>
    <flags>
        <flag id="red-flag" name="⚐" shared="true" points-rate="1" pickup-kit="flag-kit" drop-kit="reset-health" carry-kit="flag-effects" flag-proximity-metric="none" beam="false" show-sidebar="false">
            <post return-time="0s" respawn-time="10s">
                <post name="Red Post" yaw="-45">6.5,9,6.5</post>
            </post>
        </flag>
        <flag id="blue-flag" name="⚐" color="blue" shared="true" points-rate="1" pickup-kit="flag-kit" drop-kit="reset-health" carry-kit="flag-effects" flag-proximity-metric="none" beam="false" show-sidebar="false">
            <post return-time="0s" respawn-time="10s">
                <post name="Blue Post" yaw="45">-5.5,9,6.5</post>
            </post>
        </flag>
        <flag id="yellow-flag" name="⚐" color="yellow" shared="true" points-rate="1" pickup-kit="flag-kit" drop-kit="reset-health" carry-kit="flag-effects" flag-proximity-metric="none" beam="false" show-sidebar="false">
            <post return-time="0s" respawn-time="10s">
                <post name="Yellow Post" yaw="135">-5.5,9,-5.5</post>
            </post>
        </flag>
        <flag id="green-flag" name="⚐" color="lime" shared="true" points-rate="1" pickup-kit="flag-kit" drop-kit="reset-health" carry-kit="flag-effects" flag-proximity-metric="none" beam="false" show-sidebar="false">
            <post return-time="0s" respawn-time="10s">
                <post name="Green Post" yaw="-135">6.5,9,-5.5</post>
            </post>
        </flag>
        <flag id="magenta-flag" name="⚑" color="magenta" shared="true" points-rate="3" pickup-kit="magenta-kit" drop-kit="reset-health" carry-kit="flag-effects" flag-proximity-metric="none" beam="false" show-sidebar="false">
            <post return-time="0s" respawn-time="15s">
                <post name="Magenta Post" yaw="0">0.5,7,0.5</post>
            </post>
        </flag>
    </flags>
    <actions>
        <trigger scope="player" filter="all(red-checker,not(flag-remover))">
            <action scope="player">
                <kit id="air-kit"/>
            </action>
        </trigger>
        <trigger scope="player" filter="all(blue-checker,not(flag-remover))">
            <action scope="player">
                <kit id="air-kit"/>
            </action>
        </trigger>
        <trigger scope="player" filter="all(yellow-checker,not(flag-remover))">
            <action scope="player">
                <kit id="air-kit"/>
            </action>
        </trigger>
        <trigger scope="player" filter="all(green-checker,not(flag-remover))">
            <action scope="player">
                <kit id="air-kit"/>
            </action>
        </trigger>
        <trigger scope="player" filter="all(magenta-checker,not(flag-remover))">
            <action scope="player">
                <kit id="air-kit"/>
            </action>
        </trigger>
    </actions>
    <broadcasts>
        <alert after="3s" count="1">`c⚐ `9⚐ `e⚐ `a⚐ `reach give 1 point per second</alert>
        <alert after="5s" count="1">`d`l⚑ `rgives 3 points per second</alert>
        <alert after="7s" count="1">If you have a flag and leave the redstone area at mid, your flag will be dropped!</alert>
    </broadcasts>
    <time>10m</time>
    <respawn auto="true"/>
    <score>
        <limit>500</limit>
        <kills>1</kills>
    </score>
    <hunger>
        <depletion>off</depletion>
    </hunger>
</map>